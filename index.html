<!doctype html>
<html lang="en">
<meta charset="utf-8">
<title>PiEdge EduKit — Micro-lesson (30 min)</title>

<body>
    <h1>PiEdge EduKit — Self-contained Micro-lesson (~30 min)</h1>

    <p><b>Purpose:</b> Train a tiny image classifier, export to ONNX, benchmark CPU latency and compare FP32 vs INT8.
        End with auto-verification that generates JSON receipt.</p>
    <p><a href="index.sv.html">Svenska versionen</a></p>

    <h2>Time Budget</h2>
    <p>Approx. <strong>~30 minutes</strong> of active time, with fast defaults (1 epoch, small batches).</p>

    <h2>Hardware Notes</h2>
    <p>This lesson runs on CPU by default. GPU is optional; if used, ensure compatible drivers/toolkits and ≥16 GB VRAM
        for large models. The verification criteria do not require a GPU.</p>

    <h2>Prerequisites</h2>
    <ul>
        <li>OS: Ubuntu 22.04 / macOS (Intel/Apple Silicon) / Windows 11</li>
        <li>Python 3.12 installed</li>
        <li>Terminal. No admin installations required beyond local venv.</li>
    </ul>

    <h2>Step 1 — Create and activate <code>.venv</code></h2>
    <pre>
bash scripts/setup_venv.sh
# Activate (Linux/macOS):
source .venv/bin/activate
# Activate (Windows PowerShell):
.venv\Scripts\Activate.ps1
</pre>
    <details>
        <summary>Hint</summary>If pip is missing, run <code>python -m ensurepip --upgrade</code> before
        installation.<br>
        Alternative with uv: <code>uv venv && source .venv/bin/activate && uv pip install -r requirements.txt</code>
    </details>

    <h2>Step 2 — Run Smoke Test (default)</h2>
    <p><strong>Note:</strong> Om <code>data/train</code> saknas skapas ett litet syntetiskt set automatiskt vid körning.</p>
    <pre>
python -m piedge_edukit.train --fakedata --no-pretrained --epochs 1 --batch-size 256 --output-dir ./models
python -m piedge_edukit.benchmark --fakedata --model-path ./models/model.onnx --warmup 1 --runs 3 --providers CPUExecutionProvider
python -m piedge_edukit.quantization --data-path data/train --model-path ./models/model.onnx --calib-size 32 || echo "INT8 fail är OK"
python scripts/evaluate_onnx.py --model ./models/model.onnx --fakedata --limit 32
python verify.py
</pre>
    <p>This runs: training (1 epoch, fast), export, benchmark (3 runs), quantization, evaluation (32 samples) and
        finally auto-verification.</p>

    <h2>Optional: Pretty Demo (Nice Graphs)</h2>
    <p>For demonstration with clear training curves and stable confusion matrix:</p>
    <pre>
# Windows (Git Bash eller PowerShell)
scripts\demo_pretty.bat

# macOS / Linux  
bash scripts/demo_pretty.sh
</pre>
    <p>This runs: training (5 epochs, batch-size 16) → benchmark (200 runs) → evaluation (200 samples) → automatically
        opens PNG images.</p>
    <p><strong>Note:</strong> Smoke Test shows 1 point (with markers), Pretty Demo shows 5-point curves. Both give
        <strong>PASS</strong> in <code>verify.py</code>.</p>

    <h2>Step 3 — Look at the results</h2>
    <ul>
        <li><code>reports/latency_summary.txt</code></li>
        <li><code>reports/quantization_comparison.csv</code></li>
        <li><code>reports/confusion_matrix.png</code>, <code>reports/eval_summary.txt</code></li>
        <li><code>progress/receipt.json</code> (auto-receipt)</li>
    </ul>

    <h2>Automatic verification</h2>
    <p>Run anytime:</p>
    <pre>python verify.py</pre>
    <p>This updates <code>progress/receipt.json</code> and returns PASS/FAIL with clear reasons.</p>

    <h2>Common pitfalls</h2>
    <ul>
        <li><b>Apple Silicon:</b> We install <code>onnxruntime-silicon</code> automatically via environment markers.
        </li>
        <li><b>Windows PowerShell:</b> Run <code>Set-ExecutionPolicy -Scope CurrentUser RemoteSigned</code> to enable
            venv scripts. For .bat files: run <code>run_lesson.bat</code> directly.</li>
        <li><b>Windows venv issues:</b> If <code>bash scripts/setup_venv.sh</code> fails with permission errors, try
            <code>py -3.12 -m pip install --user -r requirements.txt</code> and
            <code>py -3.12 -m pip install --user -e .</code> instead.
        </li>
        <li><b>Python 3.12:</b> Ensure Python 3.12 is installed. Check with <code>python --version</code>.</li>
    </ul>

    <h2>Package for submission</h2>
    <p>Zip name suggestion: <code>Lesson_PiEdge_YYYYMMDD.zip</code>. Include the entire project root.</p>
    <p>Use: <code>bash scripts/lesson_pack.sh</code> for automatic packaging.</p>

    <h2>For instructors</h2>
    <p><a href="RUBRIC.md">Grading rubric</a> — Objective scoring guide for student submissions.</p>
</body>

</html>